---
title: "Python 3.12 ã®æ–°æ©Ÿèƒ½è©¦ã—ã¦ã¿ãŸ"
emoji: "ğŸƒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["python"]
published: true

---

2023/10/2 ã« Python 3.12 ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

ä»Šå›ã¯ã€Python 3.12 ã®æ°—ã«ãªã£ãŸæ–°æ©Ÿèƒ½ã‚’è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚

## å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ§‹æ–‡

### Generics é–¢é€£

Python ã«ã‚‚ä»–ã®è¨€èªã®ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã®ã‚ˆã†ãªè¨˜æ³•ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

#### Generics é–¢æ•°

Python3.11 ä»¥ä¸‹ã®å ´åˆ:
```python
from typing import TypeVar

T = TypeVar('T')

def max(a: T, b: T) -> T:
    return a if a > b else b

```

Python3.12:
```python
def max[T](a: T, b: T) -> T:
    return a if a > b else b
```

#### Generics ã‚¯ãƒ©ã‚¹

Python3.11 ä»¥ä¸‹:
```python
from typing import TypeVar

T = TypeVar('T')

class Item:
    def __init__(self, value: T) -> None:
        self.value = value
```

Python3.12:
```python
class Item[T]:
    def __init__(self, value: T) -> None:
        self.value = value
```

### å‹ã‚¨ã‚¤ãƒªã‚¢ã‚¹å®£è¨€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¿½åŠ 

å‹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’å®£è¨€ã™ã‚‹ãŸã‚ã® `type` ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

Python3.11 ä»¥ä¸‹:
```python
IntOrStr = int | str

def func(value: IntOrStr) -> None:
    print(value)

```

Python3.12:
```python
type IntOrStr = int | str

def func(value: IntOrStr) -> None:
    print(value)
```

ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```python
type ListOrValue[T] = list[T] | T
```

å†å¸°çš„ãªå‹å®£è¨€æ™‚ã«æ–‡å­—åˆ—ã§å‹å®£è¨€ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã—ãŸã€‚

Python3.11 ä»¥ä¸‹:
```python
from typing import Union

Tree = list[Union[int, 'Tree']]
```

Python3.12:
```python
type Tree = list[int | Tree]
```


Python3.11 ä»¥ä¸‹ã®å‹å®£è¨€ãŒã€å¤‰æ•°ã¨æ··åŒã—ã¦ã—ã¾ã£ã¦ã‚ã‹ã‚Šã¥ã‚‰ã„ã¨æ€ã£ã¦ã„ãŸã®ã§ã€ã“ã®å¤‰æ›´ã¯å¬‰ã—ã„ã§ã™ã€‚

ä»–ã«ã‚‚æ§˜ã€…ãªæ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚è©³ç´°ã¯ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

https://peps.python.org/pep-0695/

## f-string ã®åˆ¶é™ç·©å’Œ

Python3.11 ä»¥ä¸‹ã§ã¯ f-string å†…ã®å¼ã§ã€f-string ã®å¤–å´ã®ã‚¯ã‚©ãƒ¼ãƒˆã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã›ã‚“ã—ãŸãŒã€Python3.12 ã§ã¯ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

Python3.11 ä»¥ä¸‹ã¯ SyntaxError.
```python
name = {'John': 'Doe' }
print(f'Hello { name['John'] }')
```

ãƒã‚¹ãƒˆã•ã‚ŒãŸ f-string ã‚‚ä½¿ãˆã¾ã™ã€‚

```python
print(f'Hello {f'John { f'Doe' }' }')
```

å‚è€ƒ:

https://peps.python.org/pep-0701/


## ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ãƒ¼ã”ã¨ã® GIL

Python3.12 ã§ã¯ã€åŒä¸€ãƒ—ãƒ­ã‚»ã‚¹å†…ã®ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ãƒ¼ãŒ GIL ã‚’å…±æœ‰ã—ãªã„ã‚ˆã†ã«ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸæ¨¡æ§˜ã€‚

ç¾çŠ¶ã¯ C-API ã§ã®ã¿åˆ©ç”¨å¯èƒ½ã§ã‚ã‚Šã€ ä¸€èˆ¬çš„ãª Python ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã»ã¼é–¢ä¿‚ãªã•ãã†ã€‚Python 3.13 ä»¥é™ã§ã® GIL ã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã™ã‚‹ [PEP 703](https://peps.python.org/pep-0703/) ã®ãŸã‚ã®æ©Ÿèƒ½ã ã¨æ€ã‚ã‚Œã¾ã™ã€‚

å‚è€ƒ:

https://peps.python.org/pep-0684/


## å‹ãƒ’ãƒ³ãƒˆé–¢é€£

### `**kwargs` ã®æ­£ç¢ºãªå‹ä»˜ã‘

Python 3.11 ä»¥ä¸‹ã§ã¯ã€ `**kwargs` ã®å€¤ãŒåŒã˜ã§ã‚ã‚Œã°å‹ã‚’ä»˜ä¸ã§ãã¾ã—ãŸã€‚

```python
# **kwargs : dict[str, int]
def func(**kwargs: int) -> None:
    print(kwargs)

func(a=1, b=2)
```

Python 3.12 ã§ã¯ã€ `**kwargs` ã®å€¤ãŒç•°ãªã‚‹å ´åˆã§ã‚‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã”ã¨ã«ã€ `TypedDict` ã§å‹ã‚’ä»˜ä¸ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```python

from typing import TypedDict, Unpack

class Args(TypedDict):
    a: str
    b: int

def func(**kwargs: Unpack[Args]) -> None:
    print(kwargs)

func(a='a', b=1)
```

å‚è€ƒ:

https://peps.python.org/pep-0692/

### `@override` ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼

Python 3.12 ã§ã¯ã€ `@override` ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

`@override` ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ãŒè¦ªã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¦ã„ã‚‹ã“ã¨ã‚’æ˜ç¤ºçš„ã«ç¤ºã™ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚

```python
from typing import override

class Parent:
    def func(self) -> None:
        pass

class Child(Parent):
    @override
    def func(self) -> None:
        pass
```

## å‚è€ƒ

https://docs.python.org/3.12/whatsnew/3.12.html
